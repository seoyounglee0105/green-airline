<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.green.airline.repository.interfaces.TicketPaymentRepository">

<insert id="insert">
	INSERT INTO ticket_payment_tb
	VALUES (#{tid}, #{ticketId1}, #{ticketId2}, #{amount1}, #{amount2}, 0, 0);
</insert>

<update id="updateStatus">
	UPDATE ticket_payment_tb SET status1 = #{status1}, status2 = #{status2}
	WHERE ticket_id1 = #{ticketId} OR ticket_id2 = #{ticketId}
</update>

<update id="updateStatusByTid">
	
	<if test="type == 1">
		UPDATE ticket_payment_tb SET status1 = #{status}
		WHERE tid = #{tid}
	</if>
	<if test="type == 2">
		UPDATE ticket_payment_tb SET status2 = #{status}
		WHERE tid = #{tid}
	</if>

</update>

<select id="selectByTicketId" resultType="com.green.airline.repository.model.TicketPayment">
	SELECT * 
	FROM ticket_tb AS t
	JOIN ticket_payment_tb AS tp
	ON t.id IN (tp.ticket_id1, tp.ticket_id2)
	WHERE t.id = #{id}
</select>

</mapper>
